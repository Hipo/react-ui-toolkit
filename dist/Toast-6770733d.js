"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=require("react"),a=t(e),s=t(require("classnames")),o=require("./List.js"),r=require("./ListItem.js"),n=require("./_tslib-235dc327.js"),i=require("./numberUtils-df7b14d6.js"),u=require("./Button.js"),c=require("./arrayUtils-63ea95a2.js"),d=t(require("react-dom"));var l=e.createContext({toastId:""});function _(t){var s=t.customRootId,r=n.__read(v(),1)[0],i=n.__read(e.useState(null),2),u=i[0],c=i[1];return e.useLayoutEffect((function(){var t=s&&document.querySelector("#"+s);if(t)c(t);else{var e=document.createElement("div");e.setAttribute("id","toast-root"),document.body.append(e),c(e)}}),[s]),u&&d.createPortal(r.toastStack.length?a.createElement(o,{testid:"ToastStack",items:r.toastStack,customClassName:"toast-stack"},(function(t,e){return a.createElement(g,{testid:e,data:t})})):a.createElement(e.Fragment,null),u)}l.displayName="ToastItemContext";var m={toastStack:[],autoCloseToasts:!0,defaultAutoCloseTimeout:4e3};function f(t){return function(e){return!t(e)}}function T(t){return function(e){return t===e.id}}function C(t,e){var a=t;switch(e.type){case"DISPLAY":var s=e.toastData,o=n.__spread(t.toastStack.filter(f(T(s.id))),[s]);a=n.__assign(n.__assign({},t),{toastStack:c.limitArrayLengthFromTheEnd(t.limit,o)});break;case"HIDE":a=n.__assign(n.__assign({},t),{toastStack:t.toastStack.filter(f(T(e.toastId)))});break;case"HIDE_ALL":a=n.__assign(n.__assign({},t),{toastStack:[]});break;case"UPDATE":var r=t.toastStack.findIndex(T(e.toastId));if(!(r>-1))throw new Error("Trying to update a Toast that is already removed");a=n.__assign(n.__assign({},t),{toastStack:c.updateAtIndex(t.toastStack,r,n.__assign(n.__assign({},t.toastStack[r]),e.toastData))});break;case"SET_LIMIT":var u=e.limit;a=n.__assign(n.__assign({},t),{limit:u,toastStack:c.limitArrayLengthFromTheEnd(u,t.toastStack)});break;case"SET_AUTO_CLOSE":a=n.__assign(n.__assign({},t),{autoCloseToasts:e.autoCloseToasts});break;case"SET_DEFAULT_AUTO_CLOSE_TIMEOUT_FOR_ALL_TOASTS":var d=e.timeout;i.isNonNegativeNumber(d)&&(a=n.__assign(n.__assign({},t),{defaultAutoCloseTimeout:d}))}return a}var E=e.createContext([m,function(){}]);function v(){var t=e.useContext(E);if(!t)throw new Error("Trying to consume ToastContext outside of its provider.");return t}function S(){var t=v()[1];return{display:e.useCallback((function(e){var a,s,o,r,i,u,c=e.id||(o=(s=a||{}).radix,r=void 0===o?36:o,i=s.substringStartIndex,u=void 0===i?7:i,Math.random().toString(r).substring(u));return t({type:"DISPLAY",toastData:n.__assign(n.__assign({},e),{id:c})}),c}),[t]),hide:e.useCallback((function(e){t({type:"HIDE",toastId:e})}),[t]),update:e.useCallback((function(e,a){t({type:"UPDATE",toastId:e,toastData:a})}),[t]),hideAll:e.useCallback((function(){t({type:"HIDE_ALL"})}),[t])}}function g(t){var o=t.testid,i=t.data,u=n.__read(v(),1)[0],c=S().hide,d=i.timeout,_=void 0===d?u.defaultAutoCloseTimeout:d,m=i.render,f=i.customClassName,T=i.id,C="boolean"==typeof i.autoClose?i.autoClose:u.autoCloseToasts;return e.useLayoutEffect((function(){var t;return C&&(t=setTimeout((function(){c(T)}),_)),function(){t&&clearTimeout(t)}}),[C,_,c,T]),a.createElement(l.Provider,{value:{toastId:T}},a.createElement(r,{testid:o,customClassName:s("toast",f)},m()))}E.displayName="ToastContext",g.CloseButton=function(t){var s=t.children,o=t.testid,r=S().hide,n=function(){var t=e.useContext(l);if(!t)throw new Error("Trying to consume ToastItemContext outside of its provider");return t}().toastId;return a.createElement(u,{testid:o,onClick:function(){r(n)},customClassName:"toast-close-button"},s)},exports.Toast=g,exports.ToastContext=E,exports.ToastContextProvider=function(t){var s=t.children,o=t.customRootId,r=t.autoCloseToasts,u=void 0===r||r,c=t.limit,d=t.defaultAutoCloseTimeout,l=void 0===d?4e3:d,f=n.__read(e.useReducer(C,n.__assign(n.__assign({},m),{autoCloseToasts:u,limit:c,defaultAutoCloseTimeout:l})),2),T=f[0],v=f[1];return e.useEffect((function(){i.isNonNegativeNumber(c)&&v({type:"SET_LIMIT",limit:c})}),[c]),e.useEffect((function(){v({type:"SET_AUTO_CLOSE",autoCloseToasts:u})}),[u]),e.useEffect((function(){v({type:"SET_DEFAULT_AUTO_CLOSE_TIMEOUT_FOR_ALL_TOASTS",timeout:l})}),[l]),a.createElement(E.Provider,{value:[T,v]},s,a.createElement(_,{customRootId:o}))},exports.useToastContext=v,exports.useToaster=S;
