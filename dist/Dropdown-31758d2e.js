"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("react"),n=e(t),o=e(require("classnames")),s=require("./keyboardEventConstants-b582f8c1.js"),i=require("./_tslib-13fed5c7.js"),a=require("./Spinner.js"),r=require("./Button.js");function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var l=({styles:e={},...t})=>n.createElement("svg",d({width:"10",height:"5",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M5 5l5-5H0l5 5z",fill:"#222"}));function c(e){var s=e.testid,i=e.option,a=e.selectedOption,r=e.onSelect,d=e.focusedOption,l=e.onFocus,c=e.onKeyDown,u=e.onMouseDown,p=e.onMouseUp,m=e.canSelectAlreadySelected,f=void 0!==m&&m,E=e.focusedItemRef,_=i.id,h=i.customClassName,w=i.icon,v=i.title,b=i.subtitle,O=i.CustomContent,D=Boolean(a&&_===a.id),g=!i.isDisabled&&(!D||f),S=o("dropdown-list-item",h,{"dropdown-list-item--is-selected":D,"dropdown-list-item--is-focused":Boolean(d&&_===d.id),"dropdown-list-item--can-be-selected":g,"dropdown-list-item--is-disabled":i.isDisabled});return n.createElement("li",{ref:E,"data-testid":s,id:_,role:"option",className:S,onClick:function(e){e.preventDefault(),e.stopPropagation(),g&&r(i,e)},onFocus:N,onMouseEnter:N,onMouseDown:u,onMouseUp:p,onKeyDown:function(e){c&&c(i,e)},"aria-selected":D},O||n.createElement(t.Fragment,null,n.createElement("div",{className:"dropdown-list-item__icon"},w),n.createElement("div",{className:"dropdown-list-item__content"},n.createElement("p",{"data-testid":s+".title",className:"dropdown-list-item__title"},v),b&&n.createElement("p",{"data-testid":s+".subtitle",className:"dropdown-list-item__subtitle"},b))));function N(e){l(i,e)}}function u(e){var s=e.testid,i=e.isVisible,a=e.options,r=e.customClassName,d=e.role,l=e.ariaLabelledBy,u=e.ariaHidden,p=e.isMultiSelect,m=e.selectedOption,f=e.focusedOption,E=e.onSelect,_=e.onFocus,h=e.onKeyDown,w=e.onMouseDown,v=e.onMouseUp,b=e.canSelectAlreadySelected,O=e.noOptionsMessage,D=t.useRef(null),g=t.useRef(null),S=o("dropdown-list",r,{"dropdown-list--is-visible":i});return t.useLayoutEffect((function(){var e,t,n,o,s,a,r;i&&D.current&&g.current&&(D.current.scrollTop+=(e=D.current,t=g.current,o=e.clientHeight,s=e.scrollTop,a=t.clientHeight,r=0,(n=o-(t.offsetTop-s))<a&&(r=a-n),n>o&&(r=o-n),r))}),[i,f]),n.createElement("ul",{ref:D,"data-testid":s,role:d,"aria-labelledby":l,"aria-hidden":u,"aria-multiselectable":p,className:S},a.length?a.map((function(e,t){return n.createElement(c,{key:e.id,focusedItemRef:e.id===(null==f?void 0:f.id)?g:void 0,testid:s+".item-"+t,option:e,selectedOption:m,focusedOption:f,onSelect:E,onMouseDown:w,onMouseUp:v,onFocus:_,onKeyDown:h,canSelectAlreadySelected:b})})):n.createElement("li",{className:"dropdown-list-item dropdown-list__empty-message-item"},n.createElement("p",{"data-testid":s+".empty-message",className:"dropdown-list__empty-message"},O||"No available options")))}function p(e,t,n){var o=t.findIndex((function(e){return e.id===(n&&n.id)})),s=0;return o>-1?s=o:"top"===e&&(s=t.length-1),s}var m={id:"DROPDOWN_DESELECT_OPTION",title:""},f=/^[a-z0-9]$/i;exports.CaretDownIcon=l,exports.Dropdown=function(e){var d=e.testid,c=e.header,E=e.placeholder,_=e.customClassName,h=e.position,w=void 0===h?"bottom":h,v=e.role,b=e.isMultiSelect,O=void 0!==b&&b,D=e.options,g=e.selectedOption,S=e.onSelect,N=e.canSelectAlreadySelected,y=void 0!==N&&N,M=e.hasHeaderBoxShadow,C=void 0!==M&&M,R=e.hasDeselectOption,T=void 0===R||R,L=e.hasError,B=e.isDisabled,x=e.isMenuOpenHook,K=e.headerWithoutButton,A=e.customSpinner,P=e.shouldCloseOnSelect,k=void 0===P||P,F=e.onMenuVisibilityChange,I=e.areOptionsFetching,H=void 0!==I&&I,Y=e.deselectOptionTitle,j=void 0===Y?"":Y,U=e.noOptionsMessage,V=e.headerButtonClassName,W=e.shouldJumpToQuery,q=void 0===W||W,z=e.shouldShowEmptyOptions,J=void 0===z||z,Q=e.canOpenDropdownMenu,$=void 0===Q||Q,G=t.useRef(null),X=i.__read(t.useState([]),2),Z=X[0],ee=X[1],te=t.useState(!1),ne=i.__read(x||te,2),oe=ne[0],se=ne[1],ie=i.__read(t.useState(!1),2),ae=ie[0],re=ie[1],de=i.__read(t.useState(""),2),le=de[0],ce=de[1],ue=i.__read(t.useState(p(w,Z,g)),2),pe=ue[0],me=ue[1],fe=i.__read(t.useState(!1),2),Ee=fe[0],_e=fe[1],he=o("dropdown",_,{"dropdown--is-open":oe,"dropdown--has-selected-option":Boolean(g||j),"dropdown--has-header-box-shadow":C,"dropdown--has-error":L,"dropdown--is-disabled":B||H}),we=oe&&(J||D.length>0),ve=A||n.createElement(a,{customClassName:"dropdown__spinner"});t.useEffect((function(){ee(D.length&&T?i.__spread([i.__assign(i.__assign({},m),{title:j})],D):D)}),[D,j,T]),t.useEffect((function(){var e;if(le&&oe){var t=function(e,t){return e.findIndex((function(e){return e.title.toLocaleLowerCase().startsWith(t.toLocaleLowerCase())}))}(Z,le);t>-1&&me(t),e=setTimeout((function(){ce("")}),500)}return function(){clearTimeout(e)}}),[le,Z,oe]);var be,Oe,De,ge=n.createElement("div",{className:"dropdown__header-button__default-content"},g&&g.icon,n.createElement("span",{className:"dropdown__header-button__text"},g?g.title:j||E),H?ve:n.createElement(l,{"aria-hidden":!0})),Se=n.createElement(r,{testid:d+".header-button",customClassName:o("button","dropdown__header-button",V,{"dropdown__header-button--has-header-box-shadow":C}),isDisabled:B||H,onMouseDown:Ce,onMouseUp:Re,onClick:Me,tabIndex:-1,"aria-haspopup":v,"aria-expanded":oe,shouldFocus:Ee},c||ge);return K&&(Se=n.createElement(t.Fragment,null,K)),be=G.current,Oe=ye,De=t.useRef(Oe),t.useEffect((function(){De.current=Oe}),[Oe]),t.useEffect((function(){function e(e){be&&e.target instanceof HTMLElement&&!be.contains(e.target)&&De.current()}return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),function(){document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[be]),t.useEffect((function(){oe?document.documentElement.classList.add("dropdown--is-menu-open"):document.documentElement.classList.remove("dropdown--is-menu-open"),F&&F(oe?"open":"closed")}),[oe,F]),n.createElement("div",{ref:G,role:v,className:he,tabIndex:B?-1:0,onFocus:function(){document.hidden||ae||!$||B||se(!0)},onBlur:function(){document.hidden||ae||!oe||Me();_e(!1)},onKeyDown:function(e){var t,n=e.key;switch(n){case s.KEYBOARD_EVENT_KEY.ESCAPE:oe&&(e.stopPropagation(),Me());break;case s.KEYBOARD_EVENT_KEY.ENTER:oe&&(e.stopPropagation(),e.preventDefault(),(null===(t=Z[pe])||void 0===t?void 0:t.isDisabled)||Ne(Z[pe]));break;case s.KEYBOARD_EVENT_KEY.ARROW_DOWN:e.stopPropagation(),e.preventDefault(),me((pe+1)%Z.length);break;case s.KEYBOARD_EVENT_KEY.ARROW_UP:e.stopPropagation(),e.preventDefault(),me((pe||Z.length)-1);break;default:q&&n.match(f)&&ce(le+n)}}},Se,n.createElement(u,{testid:d,isVisible:we,customClassName:w,role:v,options:Z,selectedOption:g,focusedOption:Z[pe],onSelect:Ne,onFocus:function(e){me(Z.findIndex((function(t){return t.id===e.id})))},onMouseDown:Ce,onMouseUp:Re,ariaLabelledBy:d+".header-button",ariaHidden:!oe,isMultiSelect:O,canSelectAlreadySelected:y,noOptionsMessage:U}));function Ne(e,t){!B&&e&&("DROPDOWN_DESELECT_OPTION"===e.id?S(null,t):S(e,t),me(p(w,Z,e))),k?Me():_e(!0)}function ye(){se(!1)}function Me(){oe?ye():B||se(!0)}function Ce(){re(!0)}function Re(){re(!1)}};
