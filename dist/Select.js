"use strict";var e=require("./_tslib-774feabd.js"),t=require("react"),n=require("classnames"),r=require("./check-ee1d93d1.js"),o=require("./Button.js"),s=require("./keyboardEventConstants-a3d7fb76.js"),a=require("./List.js");require("./Spinner.js"),require("uuid");var i=t.createContext(null),l=t.createContext(null);function u(){var e=t.useContext(i);if(!e)throw new Error("You can only use SelectContext within a component tree that is rooted with SelectContext.Provider.");return e}function c(){var e=t.useContext(l);if(!e)throw new Error("You can only use SelectDispatchContext within a component tree that is rooted with SelectDispatchContext.Provider.");return e}i.displayName="SelectContext";var d=t.forwardRef((function(e,r){var o=e.children,s=e.customClassName,a=u().isMenuOpen,i=n("select-content",s,{"select-content--is-visible":a});return t.createElement("div",{ref:r,hidden:!a,className:i},o)}));var E=t.forwardRef((function(r,o){var s=r.children,a=r.customClassName,i=e.__rest(r,["children","customClassName"]);return t.createElement("div",e.__assign({ref:o,className:n("select-group",a),role:"group"},i),s)}));var _=t.forwardRef((function(e,o){var s=e.option,a=e.children,i=e.customClassName,l=e.onKeyDown,d=e.as,E=void 0===d?"div":d,_=u(),p=c(),f=_.onSelect,v=_.value,m=_.focusedOptionIndex,O=_.shouldCloseOnSelect,I=_.options.findIndex((function(e){return(null==e?void 0:e.id)===(null==s?void 0:s.id)})),N=Array.isArray(v)?Boolean(v.find((function(e){return e.id===(null==s?void 0:s.id)}))):(null==v?void 0:v.id)===(null==s?void 0:s.id),D=m===I,y=n("select-item",i,{"select-item--is-disabled":null==s?void 0:s.isDisabled,"select-item--is-selected":N,"select-item--is-focused":D}),C=t.useRef(null);return t.useImperativeHandle(o,(function(){return C.current}),[]),t.useLayoutEffect((function(){D&&C.current&&C.current.focus()}),[D]),t.createElement(E,{ref:C,className:y,role:"option",id:null==s?void 0:s.id,tabIndex:(null==s?void 0:s.isDisabled)?-1:0,"aria-selected":N,onClick:function(){(null==s?void 0:s.isDisabled)||(f(s),p({type:"SET_FOCUSED_OPTION_INDEX",payload:I}),O&&p({type:"TOGGLE_MENU_VISIBILITY"}))},onKeyDown:function(e){l&&l(s,e)}},a," ",N&&t.createElement(r.CheckIcon,null))}));var p=t.forwardRef((function(r,s){var a=r.customClassName,i=r.children,l=r.onClick;r.onKeyDown;var d=e.__rest(r,["customClassName","children","onClick","onKeyDown"]),E=u(),_=E.role,p=E.isMenuOpen,f=E.isDisabled,v=c(),m=t.useRef(null);return t.useImperativeHandle(s,(function(){return m.current})),t.createElement(o,e.__assign({ref:m,customClassName:n("select-trigger",a),"aria-haspopup":_,"aria-expanded":p,onClick:function(e){if(f)return;v({type:"TOGGLE_MENU_VISIBILITY"}),l&&l(e)}},d),i)}));var f=t.forwardRef((function(r,o){var s=r.options,i=r.customClassName,l=r.contentRenderer,u=e.__rest(r,["options","customClassName","contentRenderer"]);return t.createElement(a,e.__assign({ref:o,items:s,customClassName:(n("select-item-list"),i)},u),(function(e,n){return t.createElement(m.Item,{key:n,as:"li",option:e,customClassName:"select-item-list__item"},l(e))}))}));function v(t,n){var r=t;switch(n.type){case"TOGGLE_MENU_VISIBILITY":r=e.__assign(e.__assign({},t),{isMenuOpen:!t.isMenuOpen,focusedOptionIndex:-1});break;case"SET_FOCUSED_OPTION_INDEX":r=e.__assign(e.__assign({},t),{focusedOptionIndex:n.payload})}return r}var m=Object.assign(t.forwardRef((function(r,o){var a,u,c,d,E,_,p,f,m,O,I=r.children,N=r.role,D=void 0===N?"listbox":N,y=r.customClassName,C=r.value,h=e.__read(t.useReducer(v,{focusedOptionIndex:-1,isMenuOpen:!1,options:r.options||[]}),2),T=h[0],S=h[1],b=t.useRef(null),g=function(t,n){var r,o,s,a;return e.__assign({isDisabled:null!==(r=n.isDisabled)&&void 0!==r&&r,hasError:null!==(o=n.hasError)&&void 0!==o&&o,value:n.value||null,onSelect:n.onSelect,shouldCloseOnSelect:null===(s=n.shouldCloseOnSelect)||void 0===s||s,role:null!==(a=n.role)&&void 0!==a?a:"listbox"},t)}(T,r),R=(a=g,u=S,c=a.isMenuOpen,d=a.focusedOptionIndex,E=a.onSelect,_=a.shouldCloseOnSelect,p=a.options,{handleSelectKeyDown:t.useCallback((function(e){var t;switch(e.key){case s.KEYBOARD_EVENT_KEY.TAB:c&&(e.preventDefault(),u({type:"TOGGLE_MENU_VISIBILITY"}));break;case s.KEYBOARD_EVENT_KEY.ESCAPE:c&&u({type:"TOGGLE_MENU_VISIBILITY"});break;case s.KEYBOARD_EVENT_KEY.ENTER:case s.KEYBOARD_EVENT_KEY.SPACE:c&&(e.stopPropagation(),e.preventDefault(),Boolean(p[d])&&!(null===(t=p[d])||void 0===t?void 0:t.isDisabled)&&(E(p[d]),u(_?{type:"TOGGLE_MENU_VISIBILITY"}:{type:"SET_FOCUSED_OPTION_INDEX",payload:-1})));break;case s.KEYBOARD_EVENT_KEY.ARROW_DOWN:e.stopPropagation(),e.preventDefault(),u({type:"SET_FOCUSED_OPTION_INDEX",payload:(d+1)%p.length});break;case s.KEYBOARD_EVENT_KEY.ARROW_UP:e.stopPropagation(),e.preventDefault(),u({type:"SET_FOCUSED_OPTION_INDEX",payload:(d||p.length)-1});break;case s.KEYBOARD_EVENT_KEY.HOME:e.stopPropagation(),e.preventDefault(),u({type:"SET_FOCUSED_OPTION_INDEX",payload:0});break;case s.KEYBOARD_EVENT_KEY.END:e.stopPropagation(),e.preventDefault(),u({type:"SET_FOCUSED_OPTION_INDEX",payload:p.length-1})}}),[u,d,c,p,E,_])}).handleSelectKeyDown,w=function(e,t){var r=e.isMenuOpen,o=e.value,s=e.hasError,a=e.isDisabled,i=Array.isArray(o);return n("select",t,{"select--is-disabled":a,"select--is-multi-select":i,"select--has-selected-option":Array.isArray(o)?Boolean(o.length):Boolean(o),"select--has-error":s,"select--is-open":r})}(g,y);return f=null==b?void 0:b.current,m=function(){T.isMenuOpen&&S({type:"TOGGLE_MENU_VISIBILITY"})},O=t.useRef(m),t.useEffect((function(){O.current=m}),[m]),t.useEffect((function(){function e(e){f&&e.target instanceof HTMLElement&&!f.contains(e.target)&&O.current()}return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),function(){document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[f]),t.useImperativeHandle(o,(function(){return b.current})),t.createElement("div",{ref:b,className:w,role:D,onKeyDown:R,"aria-multiselectable":Array.isArray(C)},t.createElement(i.Provider,{value:g},t.createElement(l.Provider,{value:S},I)))})),{Content:d,Group:E,Item:_,Trigger:p,ItemList:f});module.exports=m;
