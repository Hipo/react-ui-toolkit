"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=require("react"),a=t(e),s=t(require("classnames")),o=require("./List.js"),r=require("./ListItem.js"),n=require("./_tslib-08dd1896.js"),i=require("./numberUtils-367b4c56.js"),u=require("./Button.js"),c=require("./arrayUtils-8731c3e2.js"),l=t(require("react-dom"));var d=e.createContext({toastId:""});function _(t){var s=t.customRootId,r=S(),i=n.__read(e.useState(null),2),u=i[0],c=i[1];return e.useLayoutEffect((function(){var t=s&&document.querySelector("#"+s);if(t)c(t);else{var e=document.createElement("div");e.setAttribute("id","toast-root"),document.body.append(e),c(e)}}),[s]),u&&l.createPortal(r.toastStack.length?a.createElement(o,{testid:"ToastStack",items:r.toastStack,customClassName:"toast-stack"},(function(t,e){return a.createElement(I,{testid:e,data:t})})):a.createElement(e.Fragment,null),u)}d.displayName="ToastItemContext";var m={toastStack:[],autoCloseToasts:!0,defaultAutoCloseTimeout:4e3};function T(t){return function(e){return!t(e)}}function f(t){return function(e){return t===e.id}}function C(t,e){var a=t;switch(e.type){case"DISPLAY":var s=e.toastData,o=n.__spread(t.toastStack.filter(T(f(s.id))),[s]);a=n.__assign(n.__assign({},t),{toastStack:c.limitArrayLengthFromTheEnd(t.limit,o)});break;case"HIDE":a=n.__assign(n.__assign({},t),{toastStack:t.toastStack.filter(T(f(e.toastId)))});break;case"HIDE_ALL":a=n.__assign(n.__assign({},t),{toastStack:[]});break;case"UPDATE":var r=t.toastStack.findIndex(f(e.toastId));if(!(r>-1))throw new Error("Trying to update a Toast that is already removed");a=n.__assign(n.__assign({},t),{toastStack:c.updateAtIndex(t.toastStack,r,n.__assign(n.__assign({},t.toastStack[r]),e.toastData))});break;case"SET_LIMIT":var u=e.limit;a=n.__assign(n.__assign({},t),{limit:u,toastStack:c.limitArrayLengthFromTheEnd(u,t.toastStack)});break;case"SET_AUTO_CLOSE":a=n.__assign(n.__assign({},t),{autoCloseToasts:e.autoCloseToasts});break;case"SET_DEFAULT_AUTO_CLOSE_TIMEOUT_FOR_ALL_TOASTS":var l=e.timeout;i.isNonNegativeNumber(l)&&(a=n.__assign(n.__assign({},t),{defaultAutoCloseTimeout:l}))}return a}var E=e.createContext(m),v=e.createContext((function(){}));function S(){var t=e.useContext(E);if(!t)throw new Error("Trying to consume ToastContext outside of its provider.");return t}function g(){var t=e.useContext(v);return{display:e.useCallback((function(e){var a,s,o,r,i,u,c=e.id||(o=(s=a||{}).radix,r=void 0===o?36:o,i=s.substringStartIndex,u=void 0===i?7:i,Math.random().toString(r).substring(u));return t({type:"DISPLAY",toastData:n.__assign(n.__assign({},e),{id:c})}),c}),[t]),hide:e.useCallback((function(e){t({type:"HIDE",toastId:e})}),[t]),update:e.useCallback((function(e,a){t({type:"UPDATE",toastId:e,toastData:a})}),[t]),hideAll:e.useCallback((function(){t({type:"HIDE_ALL"})}),[t])}}function p(){var t=e.useContext(d);if(!t)throw new Error("Trying to consume ToastItemContext outside of its provider");return t}function I(t){var o=t.testid,n=t.data,i=S(),u=g().hide,c=n.timeout,l=void 0===c?i.defaultAutoCloseTimeout:c,_=n.render,m=n.customClassName,T=n.id,f="boolean"==typeof n.autoClose?n.autoClose:i.autoCloseToasts;return e.useLayoutEffect((function(){var t;return f&&(t=setTimeout((function(){u(T)}),l)),function(){t&&clearTimeout(t)}}),[f,l,u,T]),a.createElement(d.Provider,{value:{toastId:T}},a.createElement(r,{testid:o,customClassName:s("toast",m)},_()))}v.displayName="ToastContext",I.CloseButton=function(t){var e=t.children,s=t.testid,o=g().hide,r=p().toastId;return a.createElement(u,{testid:s,onClick:function(){o(r)},customClassName:"toast-close-button"},e)},exports.Toast=I,exports.ToastContextProvider=function(t){var s=t.children,o=t.customRootId,r=t.autoCloseToasts,u=void 0===r||r,c=t.limit,l=t.defaultAutoCloseTimeout,d=void 0===l?4e3:l,T=n.__read(e.useReducer(C,n.__assign(n.__assign({},m),{autoCloseToasts:u,limit:c,defaultAutoCloseTimeout:d})),2),f=T[0],S=T[1];return e.useEffect((function(){i.isNonNegativeNumber(c)&&S({type:"SET_LIMIT",limit:c})}),[c]),e.useEffect((function(){S({type:"SET_AUTO_CLOSE",autoCloseToasts:u})}),[u]),e.useEffect((function(){S({type:"SET_DEFAULT_AUTO_CLOSE_TIMEOUT_FOR_ALL_TOASTS",timeout:d})}),[d]),a.createElement(E.Provider,{value:f},a.createElement(v.Provider,{value:S},s,a.createElement(_,{customRootId:o})))},exports.ToastDispatchContext=v,exports.ToastStateContext=E,exports.useToastItemContext=p,exports.useToastState=S,exports.useToaster=g;
