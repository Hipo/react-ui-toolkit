"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=require("react"),a=t(e),o=t(require("classnames")),s=require("./List.js"),r=require("./ListItem.js"),n=require("./_tslib-23757b01.js"),i=require("./numberUtils-6c18f4f2.js"),u=require("./Button.js"),c=require("./arrayUtils-244caef7.js"),l=t(require("react-dom"));var d=e.createContext({toastId:""});function _(t){var o=t.customRootId,r=S(),i=n.__read(e.useState(null),2),u=i[0],c=i[1];return e.useLayoutEffect((function(){var t=o&&document.querySelector("#"+o);if(t)c(t);else{var e=document.createElement("div");e.setAttribute("id","toast-root"),document.body.append(e),c(e)}}),[o]),u&&l.createPortal(r.toastStack.length?a.createElement(s,{testid:"ToastStack",items:r.toastStack,customClassName:"toast-stack"},(function(t,e){return a.createElement(p,{testid:e,data:t})})):a.createElement(e.Fragment,null),u)}d.displayName="ToastItemContext";var m={toastStack:[],autoCloseToasts:!0,defaultAutoCloseTimeout:4e3};function f(t){return function(e){return!t(e)}}function T(t){return function(e){return t===e.id}}function C(t,e){var a=t;switch(e.type){case"DISPLAY":var o=e.toastData,s=n.__spread(t.toastStack.filter(f(T(o.id))),[o]);a=n.__assign(n.__assign({},t),{toastStack:c.limitArrayLengthFromTheEnd(t.limit,s)});break;case"HIDE":a=n.__assign(n.__assign({},t),{toastStack:t.toastStack.filter(f(T(e.toastId)))});break;case"HIDE_ALL":a=n.__assign(n.__assign({},t),{toastStack:[]});break;case"UPDATE":var r=t.toastStack.findIndex(T(e.toastId));if(!(r>-1))throw new Error("Trying to update a Toast that is already removed");a=n.__assign(n.__assign({},t),{toastStack:c.updateAtIndex(t.toastStack,r,n.__assign(n.__assign({},t.toastStack[r]),e.toastData))});break;case"SET_LIMIT":var u=e.limit;a=n.__assign(n.__assign({},t),{limit:u,toastStack:c.limitArrayLengthFromTheEnd(u,t.toastStack)});break;case"SET_AUTO_CLOSE":a=n.__assign(n.__assign({},t),{autoCloseToasts:e.autoCloseToasts});break;case"SET_DEFAULT_AUTO_CLOSE_TIMEOUT_FOR_ALL_TOASTS":var l=e.timeout;i.isNonNegativeNumber(l)&&(a=n.__assign(n.__assign({},t),{defaultAutoCloseTimeout:l}))}return a}var E=e.createContext(null),v=e.createContext(null);function S(){var t=e.useContext(E);if(!t)throw new Error("Trying to consume ToastStateContext outside of its provider.");return t}function g(){var t=e.useContext(v);if(!t)throw new Error("Trying to consume ToastDispatchContext outside of its provider");return{display:e.useCallback((function(e){var a,o,s,r,i,u,c=e.id||(s=(o=a||{}).radix,r=void 0===s?36:s,i=o.substringStartIndex,u=void 0===i?7:i,Math.random().toString(r).substring(u));return t({type:"DISPLAY",toastData:n.__assign(n.__assign({},e),{id:c})}),c}),[t]),hide:e.useCallback((function(e){t({type:"HIDE",toastId:e})}),[t]),update:e.useCallback((function(e,a){t({type:"UPDATE",toastId:e,toastData:a})}),[t]),hideAll:e.useCallback((function(){t({type:"HIDE_ALL"})}),[t])}}function p(t){var s=t.testid,n=t.data,i=S(),u=g().hide,c=n.timeout,l=void 0===c?i.defaultAutoCloseTimeout:c,_=n.render,m=n.customClassName,f=n.id,T="boolean"==typeof n.autoClose?n.autoClose:i.autoCloseToasts;return e.useLayoutEffect((function(){var t;return T&&(t=setTimeout((function(){u(f)}),l)),function(){t&&clearTimeout(t)}}),[T,l,u,f]),a.createElement(d.Provider,{value:{toastId:f}},a.createElement(r,{testid:s,customClassName:o("toast",m)},_()))}v.displayName="ToastDispatchContext",E.displayName="ToastStateContext",p.CloseButton=function(t){var o=t.children,s=t.testid,r=g().hide,n=function(){var t=e.useContext(d);if(!t)throw new Error("Trying to consume ToastItemContext outside of its provider");return t}().toastId;return a.createElement(u,{testid:s,onClick:function(){r(n)},customClassName:"toast-close-button"},o)},exports.Toast=p,exports.ToastContextProvider=function(t){var o=t.children,s=t.customRootId,r=t.autoCloseToasts,u=void 0===r||r,c=t.limit,l=t.defaultAutoCloseTimeout,d=void 0===l?4e3:l,f=n.__read(e.useReducer(C,n.__assign(n.__assign({},m),{autoCloseToasts:u,limit:c,defaultAutoCloseTimeout:d})),2),T=f[0],S=f[1];return e.useEffect((function(){i.isNonNegativeNumber(c)&&S({type:"SET_LIMIT",limit:c})}),[c]),e.useEffect((function(){S({type:"SET_AUTO_CLOSE",autoCloseToasts:u})}),[u]),e.useEffect((function(){S({type:"SET_DEFAULT_AUTO_CLOSE_TIMEOUT_FOR_ALL_TOASTS",timeout:d})}),[d]),a.createElement(E.Provider,{value:T},a.createElement(v.Provider,{value:S},o,a.createElement(_,{customRootId:s})))},exports.ToastDispatchContext=v,exports.ToastStateContext=E,exports.useToastContextState=S,exports.useToaster=g;
